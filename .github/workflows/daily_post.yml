name: Daily Cosme Post

on:
  schedule:
    # 日本時間の午前7時35分に実行したい場合は UTC 22:35 に設定
    # - cron: '35 22 * * *'
    # 現在設定されている「15分おき」の設定
    - cron: '*/15 * * * *'
  workflow_dispatch: # 手動実行用

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4 # v3からv4へ

      - name: Set up Python
        uses: actions/setup-python@v5 # v4からv5へ
        with:
          python-version: '3.10'
          cache: 'pip' # pipのキャッシュを有効化

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
      
      - name: Run bot
        env:
          BLUESKY_HANDLE: ${{ secrets.BLUESKY_HANDLE }}
          BLUESKY_APP_PASSWORD: ${{ secrets.BLUESKY_APP_PASSWORD }}
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: python bluesky_bot.py
